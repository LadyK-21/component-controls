---
title: Testing/Jest Snapshots
route: /tutorial/testing/jest-snapshots
type: tutorial
tags:
  - testing
  - snapshots
  - jest
  - stories
order: 1
author: atanasster
---

## Overview

The [cc-cli](https://github.com/ccontrols/component-controls/tree/master/plugins/cc-cli) package automatically creates snapshot tests for your components based on the already created documentation stories.

3 levels from ease of use to full control:

- Easy to use [cli](#cli) with "zero" configuration.
- More advanced [custom tests](#custom-tests) level using compiler cli and jest cli.
- Full control [cusom scripts](/blogs/custom-test-runners) to launch the compiler and jest.

Supports a variety of test renderers:

- [react-test-renderer](https://reactjs.org/docs/test-renderer.html)
- [react-testing-library](https://testing-library.com/docs/react-testing-library/intro)
- [enzyme](https://enzymejs.github.io/enzyme/)

## Install

```sh
yarn add @component-controls/cc-cli --dev
```

## Examples

The starter projects are set up to demonstrate no-code jest snapshots:

- [gatsby](https://github.com/ccontrols/gatsby-controls-starter/blob/e177388e990479d6b7b098beb6cc0aa4789c1ea1/package.json#L9)
- [nextjs](https://github.com/ccontrols/nextjs-controls-starter/blob/cb24475032f69b3f45cfdd54ace8dce7b1896f6e/package.json#L29)
- [storybook 5](https://github.com/ccontrols/storybook-5-controls-starter/blob/efed8a95c2a5986990e85805d35a5d753cf5fa85/package.json#L9)
- [storybook 6](https://github.com/ccontrols/storybook-6-controls-starter/blob/6798935d712a38b66a99650d9002dd4b7394b581/package.json#L9)

## CLI

The command-line interface for cc-cli allows for the quickest, zero-config setup. You can add a `test:create` script to your `package.json` file

Using this approach will generate a test file in `tests/stories.test.js` that will be used by jest to generate the snapshots.

```js:title=package.json
"scripts": {
  ...
  "test:create": "cc-cli"
},
```

### CLI Parameters

| Parameter              | Explanation                                                 | Input type                  | Default value                  |
| ---------------------- | ----------------------------------------------------------- | --------------------------- | ------------------------------ |
| `--config`<br/>`-c`    | configuration files folder                                  | string                      | `.config`                      |
| `--generate`<br/>`-g`  | generate test files for whole store or story/by story files | 'store' \| 'doc' \| 'story' | `store`                        |
| `--renderer`<br/>`-r`  | jest framework renderer                                     | 'rtl' \| 'rtr' \| 'enzyme'  | `rtl`                          |
| `--output`<br/>`-o`    | generated tests output folder                               | string                      | `tests`                        |
| `--test`<br/>`-t`      | generated tests file name                                   | string                      | `stories.test.js`              |
| `--format`<br/>`-f`    | generated test files format                                 | 'cjs' \| 'esm' \| 'ts'      | `cjs`                          |
| `--overwrite`<br/>`-w` | force ovewrite existing test files                          | boolean                     | `false`                        |
| `--bundle`<br/>`-b`    | bundle path, if store loaded from bundle                    | string                      |                                |
| `--name`<br/>`-n`      | name of the test group/describe section                     | string                      | `component-controls generated` |

Examples:

```sh
yarn cc-cli -c .storybook --coverage
```

or

```sh
yarn cc-cli -c .storybook jest---coverage true
```

## Custom tests

Using this approach, you will create a custom test file and use directly jest to run your test suite. Before launching the jest tests, you will need to compile the stories using the [compiler cli](/tutorial/reference/cli)

```js:title=stories.test.js
const path = require('path');
const { renderers } = require('@component-controls/test-renderers');
const { runJestSnapshots } = require('@component-controls/jest-snapshots');

runJestSnapshots(
  renderers.enzyme,
  path.resolve(process.cwd(), 'output', 'component-controls.js'),
);
```

and in `package.json` configure a `test` script to compile the stories and then launch `jest` with the bundle in the `output` folder.

```js:title=package.json
  "scripts": {
    ...
    "test": "ccc -c .config -d output && yarn jest && rm -rf output"
  },
```

A full list of the [compiler cli parameters](/tutorial/reference/cli#parameters).

If the output folder is not specified, the bundle is located in the `public` folder

```js:title=stories.test.js
const { renderers } = require('@component-controls/test-renderers');
const { runJestSnapshots } = require('@component-controls/jest-snapshots');

runJestSnapshots(renderers.enzyme);
```

```js:title=package.json
  "scripts": {
    ...
    "test": "ccc -c .config && yarn jest && rm -rf public"
  },
```

## Custom scripts

Using this approach, you will have full control over the stories bundle to select which stories to test.

A more detailed article on creating custom test scripts can be found [here](/blogs/custom-test-runners)
